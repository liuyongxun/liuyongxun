---
layout: post
title: "数据质量检查总结"
comments: true
share: true
tags: 数据学习
---
###**数据质量检查总结**		
取数作为专题分析工作的一项重要工作。如果取数得到的数据不准确的时候，就很难能够得到准确的分析结果。这里所说的数据的准确性，也就是说取数获得的数据必须要符合专题
分析对数据的要求。因此在完成取数的工作之后有必要对数据的质量进行检查。该如何来进行检查工作呢？		
####**数据质量检查四部曲**		
根据前辈总结的经验，并结合移动专题分析项目的具体情况，我们将数据检查的工作总结为以下四个步骤：
####**1、取数SQL脚本检查**	
数据是通过SQL脚本从数据仓库中获取的，所以验证数据质量的第一步就应该是检查数据的取数SQL模板是否正确。主要的检查点主要包括两个部分：
#####**检查需求理解是否正确**			
包括检查脚本的取数对象与取数范围是否正确；数据准备的口径与数据需求描述的口径是否一致；表的选择是否一致；
#####**检查转换脚本的关键点**		
脚本关键点主要包括那些会导致数据发生变动的脚本；例如LEFT JOIN 、CASE WHEN ...；通常包括以下三个部分：		

	过滤条件：看看限定条件是否齐全未遗漏；汇总的条件是否理解正确；					
	关联逻辑：在每次LEFT JOIN 完之后，要观察数据量的变化；INNER JOIN 和 LEFT JOIN 的逻辑是否正确；				
	转换逻辑：CASE WHEN 转换逻辑是否正确，是否包含全部的情况(在这里建议写CASE函数的时候，其ELSE之后的结果都令为NULL，其他可能出现的结果尽量使用WHEN来表达) ；看看计算公式是否正确；		

####**2、具体数据检查**		

	具体数据检查的原则是先总体、后样本、再具体；先从**总体的角度**出发，主要包括总体记录规模的检查（数量是否正确）；唯一性检查，检查是否出现重复的数据；重要维度检查,如日期，地市，属地等维度；
	之后从**样本的角度**出发，抽样选择少量的用户，观察数据的每一个字段是否正常，同时另外单独写SQL代码，验证两次结果是否一致。最后就从**具体数据的角度**出发，这个包括检查包括五个部分：
		**1、反向检查** ： 主要用于数字型或者日期型的数据检查，看是否存在不符合限定条件的数据。		
		**2、平均值检查**： 用于数值型字段检查，比如查询结果集中的平均APRU，如果平均APRU和之前的业务经验相比明显偏高，则表示数据可能存在问题。		
		**3、NULL值检查**：一般宽表中不建议出现空值，数值型字段的空值要转为0，字段性字段的NULL值要转为空值。			
		**4、常识检查**：比例值注意是否有大于1的情况；总分量之和对比，比如通话时长，长途、本地、漫游通话时长之和对比。
		**5、字段错误检查**：主要发生在INSERT 语句中；INSERT数据的字段位置与源表字段的顺序发生了变化，这就会导致错误发生错位的现象。		
		
####**3、关键指标核对与核对经分报表**		

针对数据的关键指标核对，主要从三个方面来进行：		
	经分报表：如果数据从经分报表来的，需要和经分数据进行核对；查看数据量是否一致；查看各维度数据是否一致。		
	需求人员的要求： 如果有些关键指标数据不在经分侧中，这就需要和需求人员进行核对；查看数据量跟需求人员的要求是否一致。	
	业务经验：一般工作了一定的时间，就会形成自己的业务经验。当没有数据核对标准的时候，就需要自己的经验去判断数据的准确性。		

####**4、常见的数据质量错误**
	目标表出现重复记录：			
	1、检查重复记录的数据是整条记录完全一致还是有部分字段相同		
	2、如果是部分字段不同、直接定位该字段的来源表，检查该表的数据记录和唯一数		
	3、如果是完全一致，则检查所有源表中的记录数和唯一数		
	4、对于源表存在重复的,确定是何种原因：关联原因造成，未限制账务月，源系统数据重复		
	5、按照一定业务规则进行排重处理		
	字段被截断：		
	1、定位被裁剪的字段			
	2、定位是否有union或者union all的SQL操作		
	3、对于union或者union all的操作，数据库默认以第一个select 操作中字段的长度来决定，			
	4、对于这种情况 可以通过对第一个select中字段进行cast来解决		










